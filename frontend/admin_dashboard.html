<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard</title>

  <link rel="icon" type="image/png" href="Images/Logo.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>

<body class="flex flex-col min-h-screen bg-gray-100">

<!-- Header Starts -->
  <header class="fixed top-0 w-full bg-green-900 text-white shadow-md py-4 px-6 flex items-center justify-between z-50">
    <div class="flex items-center gap-4">
      <!-- Sidebar Toggle Icon -->
      <button id="sidebarToggle" class="text-white focus:outline-none hover:text-green-200">
        <i class="fa-solid fa-bars text-2xl transition-all duration-300" title="Menu"></i>
      </button>

      <img src="Images/Logo.png" alt="Barangay Logo" class="w-12 h-12 rounded-full border-2 border-white">
      <h1 class="text-2xl md:text-3xl font-bold">Admin Dashboard</h1>
    </div>
  </header>
<!-- Header Ends -->


<!-- Sidebar Starts -->
  <aside id="sidebar"
         class="fixed top-0 left-0 h-full w-56 bg-green-800 text-white shadow-2xl transform -translate-x-full transition-transform duration-300 z-50 flex flex-col justify-between rounded-r-2xl">

         <!-- Hide Side Bar -->
         <button id="hideSidebar" class="absolute top-4 right-4 text-white shadow-2xl hover:text-green-300">
          <i class="fa-solid fa-arrow-left text-xl"></i>
         </button>

    <!-- Menu -->
    <nav class="flex flex-col items-center text-green-300 space-y-3 pt-24">
      <h2 class="text-xl font-bold mb-4 text-gray-100 tracking-wide border-b border-green-700 pb-2 w-4/5 text-center">
        Menu
      </h2>

      <button id="btnAnnouncements" onclick="showSection('sectionAnnouncements')"
              class="w-4/5 flex items-center justify-left gap-2 px-4 py-2 rounded-lg 
              hover:bg-green-700 hover:scale-105 transform transition duration-200 focus:outline-none
              disabled:bg-green-800 disabled:cursor-not-allowed disabled:opacity-70
              disabled:hover:bg-green-800 disabled:hover:scale-100
              disabled:border-none disabled:shadow-none disabled:text-green-500">
        <i class="fa-solid fa-bullhorn"></i>
        <span>Announcements</span>
      </button>

      <button id="btnCharts" onclick="showSection('sectionCharts')"
              class="w-4/5 flex items-center justify-left gap-2 px-4 py-2 rounded-lg 
              hover:bg-green-700 hover:scale-105 transform transition duration-200 focus:outline-none
              disabled:bg-green-800 disabled:cursor-not-allowed disabled:opacity-70
              disabled:hover:bg-green-800 disabled:hover:scale-100
              disabled:border-none disabled:shadow-none disabled:text-green-500">
        <i class="fa-solid fa-chart-column"></i>
        <span>Charts</span>
      </button>

      <button id="btnReports" onclick="showSection('sectionReports')"
              class="w-4/5 flex items-center justify-left gap-2 px-4 py-2 rounded-lg 
              hover:bg-green-700 hover:scale-105 transform transition duration-200 focus:outline-none
              disabled:bg-green-800 disabled:cursor-not-allowed disabled:opacity-70
              disabled:hover:bg-green-800 disabled:hover:scale-100
              disabled:border-none disabled:shadow-none disabled:text-green-500">
        <i class="fa-solid fa-file-lines"></i>
        <span>Reports</span>
      </button>

      <button id="btnAuditLog" onclick="showSection('sectionAuditLog')"
              class="w-4/5 flex items-center justify-left gap-2 px-4 py-2 rounded-lg 
              hover:bg-green-700 hover:scale-105 transform transition duration-200 focus:outline-none
              disabled:bg-green-800 disabled:cursor-not-allowed disabled:opacity-70
              disabled:hover:bg-green-800 disabled:hover:scale-100
              disabled:border-none disabled:shadow-none disabled:text-green-500">
        <i class="fa-solid fa-clipboard-list"></i>
        <span>Audit Log</span>
      </button>

      <button id="btnSuggestions" onclick="showSection('sectionSuggestions')"
              class="w-4/5 flex items-center justify-left gap-2 px-4 py-2 rounded-lg 
              hover:bg-green-700 hover:scale-105 transform transition duration-200 focus:outline-none
              disabled:bg-green-800 disabled:cursor-not-allowed disabled:opacity-70
              disabled:hover:bg-green-800 disabled:hover:scale-100
              disabled:border-none disabled:shadow-none disabled:text-green-500">
        <i class="fa-solid fa-lightbulb"></i>
        <span>Suggestions</span>
      </button>

    </nav>

    <!-- Account Settings -->
    <div class="p-4 flex flex-col items-center space-y-3 pb-8">
      <a href="admin_settings.html"
         class="w-4/5 flex items-center text-green-300 gap-2 py-2 rounded-lg hover:bg-green-700 hover:scale-105 transform transition duration-200">
        <i class="fa-solid fa-gear"></i>
        <span>Account Settings</span>
      </a>

      <a href="admin_signin.html"
         class="w-4/5 flex items-center justify-center gap-2 text-center bg-white text-green-900 font-semibold py-2 rounded-lg hover:bg-green-200 transition-all duration-200 hover:scale-105">
        <i class="fa-solid fa-right-from-bracket"></i>
        <span>Logout</span>
      </a>
    </div>
  </aside>
<!-- Sidebar Ends -->


  <!-- Main Content -->
  <main class="p-6 max-w-7xl mx-auto space-y-6 mt-24">

    <!-- Welcome Section -->
    <div class="bg-white outline outline-1 outline-gray-300 shadow-lg shadow-inner rounded-xl p-6 flex flex-col md:flex-row items-center md:justify-between gap-4">
      <div>
        <h2 class="text-xl font-semibold text-green-900 mb-2">Welcome, Admin!</h2>
        <p class="text-gray-700">Manage reports, announcements, and track submitted issues efficiently.</p>
      </div>
      <div class="text-center md:text-right">
        <img src="Images/Logo.png" alt="Barangay Logo" class="w-16 h-16 md:w-20 md:h-20 rounded-full mx-auto md:mx-0">
      </div>
    </div>

<!-- Announcement Section -->
<section id="sectionAnnouncements">
  <section class="bg-green-50 py-16 px-6">
    <div class="max-w-7xl mx-auto">

      <h2 class="text-4xl md:text-5xl font-extrabold text-center mb-10 text-green-900 tracking-tight drop-shadow-sm">
        Barangay Announcements & News
      </h2>

      <!-- Action Buttons -->
      <div class="flex flex-col md:flex-row justify-center items-center gap-4 mb-10">
        <button id="addAnnouncementBtn"
                class="bg-green-900 text-white px-6 py-2 rounded-lg hover:bg-green-800 transition w-48 text-center">
          Add Announcement
        </button>

        <button id="addNewsBtn"
                class="bg-green-900 text-white px-6 py-2 rounded-lg hover:bg-green-800 transition w-48 text-center">
          Add News
        </button>
      </div>

      <!-- New Announcement Form -->
<div id="announcementForm"
           class="hidden max-w-md mx-auto mb-12 bg-white shadow-md rounded-xl p-6 hover:shadow-xl transition">
        <h4 class="text-xl font-semibold text-green-800 mb-4">New Announcement</h4>

        <input id="announcementTitle" type="text" placeholder="Enter announcement title"
               class="w-full border border-gray-300 rounded-lg p-3 mb-4 focus:ring-2 focus:ring-green-700 focus:outline-none">

        <textarea id="announcementDescription" placeholder="Enter announcement description" class="w-full border border-gray-300 rounded-lg p-3 mb-4 focus:ring-2 focus:ring-green-700 focus:outline-none resize-none" rows="3"></textarea>

        <div class="flex gap-3">
            <button id="cancelAnnouncementBtn" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-1/2">
              Cancel
            </button>
            <button id="uploadAnnouncementBtn" class="bg-green-900 text-white px-4 py-2 rounded-lg hover:bg-green-800 transition w-1/2">
              Upload
            </button>
        </div>
      </div>


      <!-- New News Form -->
       <div id="newsForm"
           class="hidden max-w-md mx-auto mb-12 bg-white shadow-md rounded-xl p-6 hover:shadow-xl transition">
        <h4 class="text-xl font-semibold text-green-800 mb-4">New News Item</h4>

        <input id="newsTitle" type="text" placeholder="Enter news title"
               class="w-full border border-gray-300 rounded-lg p-3 mb-4 focus:ring-2 focus:ring-green-700 focus:outline-none">

        <textarea id="newsDescription" placeholder="Enter news description"
                  class="w-full border border-gray-300 rounded-lg p-3 mb-4 focus:ring-2 focus:ring-green-700 focus:outline-none resize-none"
                  rows="3"></textarea>

        <input id="newsLink" type="text" placeholder="Enter link (optional)"
               class="w-full border border-gray-300 rounded-lg p-3 mb-4 focus:ring-2 focus:ring-green-700 focus:outline-none">

        <input id="newsImage" type="text" placeholder="Enter image URL"
               class="w-full border border-gray-300 rounded-lg p-3 mb-4 focus:ring-2 focus:ring-green-700 focus:outline-none">

        <div class="flex gap-3">
            <button id="cancelNewsBtn" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-1/2">
              Cancel
            </button>
            <button id="uploadNewsBtn" class="bg-green-900 text-white px-4 py-2 rounded-lg hover:bg-green-800 transition w-1/2">
              Upload
            </button>
        </div>
      </div>

      <!-- Announcements Grid -->
      <div id="announcementsGrid" class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12"></div>

<!-- News Carousel -->
<div class="relative overflow-hidden">
  <div id="newsCarousel" class="flex transition-transform duration-700 ease-in-out"></div>

        <!-- Carousel Controls -->
        <button id="prevBtn"
                class="absolute left-0 top-1/2 -translate-y-1/2 bg-green-700 text-white p-3 rounded-full shadow-md hover:bg-green-800 transition z-10">
          &#10094;
        </button>
        <button id="nextBtn"
                class="absolute right-0 top-1/2 -translate-y-1/2 bg-green-700 text-white p-3 rounded-full shadow-md hover:bg-green-800 transition z-10">
          &#10095;
        </button>
      </div>

    </div>
  </section>
</section>


<!-- Chart Section -->
<section id="sectionCharts" class="">
  <section class="bg-gray-100 outline-gray-300 px-6 max-w-6xl mx-auto mb-24 mt-10 bg-white rounded-2xl shadow-md p-10">

    <h1 class="text-3xl md:text-4xl font-serif font-semibold text-gray-900 mb-8 text-center">
      Reports Overview
    </h1>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

      <!-- Bar Chart -->
      <div class="bg-gray-50 p-6 rounded-xl shadow-md">
        <h2 class="text-xl font-semibold text-gray-800 mb-4 text-center">
          Reported Issues vs Solved Issues
        </h2>

        <p class="text-center font-semibold text-gray-700">
          Reported Issues: <span id="reportedTotal">0</span> |
          Solved Reports: <span id="solvedTotal">0</span> |
          Resolved Percentage: <span id="resolvedPercent">0%</span>
        </p>
        <canvas id="barChart" height="300"></canvas>
      </div>

      <!-- Pie Chart -->
      <div class="bg-gray-50 p-6 rounded-xl shadow-md">
        <h2 class="text-xl font-semibold text-gray-800 mb-4 text-center">
          Types of Reported Issues
        </h2>
        <canvas id="pieChart"></canvas>
        <ul id="legendList" class="mt-4 space-y-2"></ul>
      </div>

    </div>

  </section>
</section>

<!-- Report Section -->
<section id="sectionReports" class="hidden">

  <!-- Search Input -->
  <div class="flex flex-col md:flex-row gap-4 mb-4">
    <input 
      type="text" 
      id="searchInput"
      placeholder="Search by name, category, status, priority, or tracking ID"
      class="border border-gray-300 rounded-lg px-4 py-2 flex-grow focus:outline-none focus:ring-2 focus:ring-green-700 shadow-sm"
    >
    
    <div class="flex-grow md:flex-none">
      <label for="dateRangeFilter" class="text-sm text-gray-600 md:hidden">Filter by Date:</label>
      <select 
        id="dateRangeFilter"
        class="border border-gray-300 rounded-lg px-4 py-2 w-full md:w-auto focus:outline-none focus:ring-2 focus:ring-green-700 shadow-sm"
      >
        <option value="all-time">All Time</option>
        <option value="today">Today</option>
        <option value="past-week">Past Week</option>
        <option value="past-month">Past Month</option>
        <option value="past-year">Past Year</option>
      </select>
    </div>
  </div>

  <!-- Records Table -->
  <div class="bg-white border border-gray-300 shadow-md rounded-xl p-6 overflow-x-auto">

    <!-- Header Row -->
     <div class="flex items-center justify-between mb-4">
      <h2 class="text-xl font-semibold text-green-900">Submitted Reports</h2>

      <div class="relative inline-block text-left">
        <button 
          id="downloadMenuBtn" 
          class="bg-green-900 text-white px-4 py-2 rounded-lg hover:bg-green-800 transition flex items-center"
          title="Download data">
          <i class="fas fa-download mr-2"></i>Download
        </button>

        <div 
          id="downloadMenu"
          class="hidden absolute right-0 mt-2 w-40 bg-white border border-gray-200 rounded-lg shadow-md z-20">
          <button id="btnAnnouncements" onclick="downloadCSV()" class="block w-full text-left px-4 py-2 text-sm hover:bg-gray-100">
            Download CSV
          </button>
          <button id="btnCharts" onclick="downloadExcel()" class="block w-full text-left px-4 py-2 text-sm hover:bg-gray-100">
            Download Excel
          </button>
          <button id="btnReports" onclick="downloadPDF()" class="block w-full text-left px-4 py-2 text-sm hover:bg-gray-100">
            Download PDF
          </button>
        </div>
      </div>
    </div>

    <!-- Table -->
    <table class="min-w-full table-auto border-collapse">
      <thead>
        <tr class="bg-green-100 text-green-900 text-center">
          <th class="px-4 py-2 border">Tracking ID</th>
          <th class="px-4 py-2 border">Name</th>
          <th class="px-4 py-2 border">Barangay ID</th>
          <th class="px-4 py-2 border">Category</th>
          <th class="px-4 py-2 border">Description</th>
          
          <th class="px-4 py-2 border">Address</th>
          
          <th class="px-4 py-2 border">Upload Evidence</th>
          <th class="px-4 py-2 border">Date Submitted</th>
          <th class="px-4 py-2 border">Status</th>
          <th class="px-4 py-2 border">Priority</th>
        </tr>
      </thead>
      
      <tbody id="reportTableBody" class="text-gray-700">
        <!-- JS will populate rows -->
      </tbody>
    </table>
  </div>
</section> 
<!-- Report Section Ends -->

</section> 

<!-- Audit Log Section Starts -->
<section id="sectionAuditLog" class="hidden">

  <div class="mb-6">
    <h2 class="text-2xl font-semibold text-green-900">Admin Audit Log</h2>
  </div>

  <div class="flex flex-col md:flex-row gap-4 mb-4">
    
    <input 
      type="text" 
      id="auditLogSearchInput"
      placeholder="Search by user, action, or description"
      class="border border-gray-300 rounded-lg px-4 py-2 flex-grow focus:outline-none focus:ring-2 focus:ring-green-700 shadow-sm"
    >

    <div class="flex flex-col md:flex-row gap-3 w-full md:w-auto">
      
      <select 
        id="auditDateFilter"
        class="border border-gray-300 rounded-lg px-4 py-2 w-full md:w-auto focus:outline-none focus:ring-2 focus:ring-green-700 shadow-sm cursor-pointer"
      >
        <option value="all-time">All Time</option>
        <option value="today">Today</option>
        <option value="past-week">Past Week</option>
        <option value="past-month">Past Month</option>
        <option value="past-year">Past Year</option>
      </select>

      <div class="relative inline-block text-left w-full md:w-auto">
        <button 
          id="auditDownloadBtn" 
          class="bg-green-900 text-white px-4 py-2 rounded-lg hover:bg-green-800 transition w-full md:w-auto flex items-center justify-center"
          title="Download log">
          <i class="fas fa-download mr-2"></i>Download
        </button>

        <div 
          id="auditDownloadMenu"
          class="hidden absolute right-0 mt-2 w-40 bg-white border border-gray-200 rounded-lg shadow-md z-20">
          <button onclick="downloadAuditCSV()" class="block w-full text-left px-4 py-2 text-sm hover:bg-gray-100">
            Download CSV
          </button>
          <button onclick="downloadAuditExcel()" class="block w-full text-left px-4 py-2 text-sm hover:bg-gray-100">
            Download Excel
          </button>
          <button onclick="downloadAuditPDF()" class="block w-full text-left px-4 py-2 text-sm hover:bg-gray-100">
            Download PDF
          </button>
        </div>
      </div>
      
    </div>
  </div>

  <div class="bg-white border border-gray-300 shadow-md rounded-xl p-6 overflow-x-auto">
    <table class="min-w-full table-auto border-collapse">
      <thead>
        <tr class="bg-green-100 text-green-900 text-center">
          <th class="px-4 py-2 border">Timestamp</th>
          <th class="px-4 py-2 border">Admin User</th>
          <th class="px-4 py-2 border">Action Type</th>
          <th class="px-4 py-2 border">Description</th>
        </tr>
      </thead>
      <tbody id="auditLogTableBody" class="text-gray-700 text-sm">
        </tbody>
    </table>
  </div>
</section>
<!-- Audit Log Section Ends -->

</section> 
<section id="sectionSuggestions" class="hidden">

    <div class="mb-4">
      <h2 class="text-2xl font-semibold text-green-900">Suggestions Mailbox</h2>
    </div>

    <div class="bg-white border border-gray-300 shadow-md rounded-xl overflow-hidden grid grid-cols-1 md:grid-cols-3" style="min-height: 600px;">

        <div class="md:col-span-1 border-r border-gray-200 bg-gray-50">

            <div class="p-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-green-800">Inbox</h3>
            </div>

            <div id="suggestion-list" class="h-[550px] overflow-y-auto">
                </div>
        </div>

        <div class="md:col-span-2 p-6">

            <div id="suggestion-placeholder" class="text-center text-gray-500 pt-20">
                <i class="fas fa-inbox text-4xl mb-4"></i>
                <h3 class="text-xl">Select a suggestion to read</h3>
                <p>Messages will be displayed here.</p>
            </div>

            <div id="suggestion-content" class="hidden">
                <div class="border-b border-gray-200 pb-4 mb-4">
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="text-sm text-gray-600">From: <span id="suggestion-from" class="font-semibold text-green-800"></span></p>
                            <p class="text-sm text-gray-600">Email: <span id="suggestion-email" class="font-semibold text-green-800"></span></p>
                        </div>
                        <p class="text-sm text-gray-600">Date: <span id="suggestion-date" class="font-semibold"></span></p>
                    </div>
                </div>

                <div class="prose max-w-none">
                    <p id="suggestion-body" class="text-gray-700 leading-relaxed whitespace-pre-wrap"></p>
                </div>

                <div class="mt-6 border-t border-gray-200 pt-4">
                    <button id="delete-suggestion-btn" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700">
                        <i class="fas fa-trash-alt mr-2"></i>Delete
                    </button>
                </div>
            </div>

        </div>
    </div>
</section>

  </main>

  <div id="addressModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50 p-4">
    <div class="bg-white p-6 rounded-xl shadow-lg w-full max-w-2xl">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-2xl font-semibold text-green-900">Report Location</h2>
        <button id="closeAddressModal" class="text-gray-500 hover:text-gray-800 text-3xl">&times;</button>
      </div>
      
      <p id="modalAddressText" class="text-gray-700 mb-4 text-lg"></p>
      
      <div id="modalMap" style="height: 400px; width: 100%;" class="rounded-lg shadow-md relative z-0"></div>
    </div>
  </div>

  <div id="descriptionModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50 p-4">
    <div class="bg-white p-6 rounded-xl shadow-lg w-full max-w-lg">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-2xl font-semibold text-green-900">Report Description</h2>
        <button id="closeDescriptionModal" class="text-gray-500 hover:text-gray-800 text-3xl">&times;</button>
      </div>
      
      <p id="modalDescriptionText" class="text-gray-700 text-base leading-relaxed whitespace-pre-wrap"></p>
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-green-900 text-white text-center py-6 mt-auto">
    <p>&copy; 2025 Barangay Reporting System. All rights reserved.</p>
  </footer>

  <!-- External JS Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

  <!-- External JS File -->
   <script src="js/logo_data.js"></script>
  <script src="js/admin_dashboard.js"></script>

</body>
</html>
